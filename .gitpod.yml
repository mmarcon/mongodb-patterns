# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

image:
  file: gitpod-config/.gitpod.Dockerfile

tasks:
  - name: Install dependencies
    init: npm i
  - name: Get a cluster
    command: |
      atlas quickstart --default --force --skipSampleData --skipMongosh --clusterName "$GITPOD_WORKSPACE_ID" > /tmp/cluster-info
      username=$(cat /tmp/cluster-info | grep Username | sed 's/.*:\s//')
      password=$(cat /tmp/cluster-info | grep Password | sed 's/.*:\s//')
      connectionstring=$(cat /tmp/cluster-info | grep string | sed 's/.*:\smongodb+srv:\/\///')
      rm /tmp/cluster-info
      echo "MONGODB_CONNECTION_STRING=mongodb+srv://$username:$password@$connectionstring" > .env

vscode:
  extensions:
    - mongodb.mongodb-vscode
    - standard.vscode-standard

# atlas clusters delete "$GITPOD_WORKSPACE_ID" --force